Please help with your inputs on Exam test questions

-------------------------------------------------------------------------------------

1) Find the pod that consumes the most CPU in all namespace(including kube-system) in all cluster(currently we have single cluster). Then, store the result in the file high_cpu_pod.txt with the following format: pod_name,namespace .

Run top command for pod (for all pods under all namespaces)

kubectl top pods --all-namespaces 

If asked for sort use below command

kubectl top pods --sort-by=cpu or mem --all-namespaces

store the output in file- high_cpu_pod.txt with the following format: pod_name,namespace

How to format store?
>>controlplane $ kubectl get pods -A -o custom-columns=POD-NAME:.metadata.name,NAMESPACE:.metadata.namespace > pod.txt
controlplane $ cat pod.txt
POD-NAME                                   NAMESPACE
nginx-bf5d5cf98-f8hp8                      default
nginx-bf5d5cf98-kgrls                      default
calico-kube-controllers-75bdb5b75d-2b6mr   kube-system
canal-q652m                                kube-system
canal-wzjz6                                kube-system
coredns-5c69dbb7bd-6xvhl                   kube-system

** SEE if this is how you want...
-------------------------------------------------------------------------------------

2) Create a Kubernetes Pod configuration to facilitate real-time monitoring of a log file. Specifically, you need to set up a Pod named alpine-pod-pod that runs an Alpine Linux container.

Requirements:

Name the Pod alpine-pod-pod
Use alpine:latest image
Container name alpine-container
Configure the container to execute the tail -f /config/log.txt command(using args ) with /bin/sh (using command ) to continuously monitor and display the contents of a log file.

Created alpine pod is going in "Completed" status or ImagePullBackoff.
** TRY THIS

controlplane $ cat alpine.yaml 
apiVersion: v1
kind: Pod
metadata:
  name: alpine-pod-pod
spec:
  containers:
  - name: alpine-container
    image: alpine:latest
    command: ["/bin/sh"] ## command to run shell inside container
    args:   [ "-c", "while true; do tail -f /config/log.txt; sleep 10;done" ]
           # args: ["-c" >> command to run in shell
           # tail will work only single time and conatiner would stop so need to loop it so while loop 

controlplane $ kubectl get pods | grep alpine
alpine-pod-pod          1/1     Running   0          3m35s


-------------------------------------------------------------------------------------------------------------------------

Question No 3- The deployment named video-app has experienced multiple rolling updates and rollbacks. Your task is to total revision of this deployment and record the image name used in 3rd revision to file app-file.txt in this format REVISION_TOTAL_COUNT,IMAGE_NAME .

Deployment yaml

apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "3"
  creationTimestamp: "2024-08-12T16:25:12Z"
  generation: 3
  labels:
    app: video-app
  name: video-app
  namespace: default
  resourceVersion: "2490"
  uid: 795fc837-1a7b-4b78-b066-c1e70806d2b9
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: video-app
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: null
      labels:
	   app: video-app
    spec:
      containers:
      - image: redis:7.0.13
        imagePullPolicy: IfNotPresent
        name: redis
        resources: {}
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: {}
      terminationGracePeriodSeconds: 30
status:
  availableReplicas: 1
  conditions:
  - lastTransitionTime: "2024-08-12T16:25:27Z"
    lastUpdateTime: "2024-08-12T16:25:27Z"
    message: Deployment has minimum availability.
    reason: MinimumReplicasAvailable
    status: "True"
    type: Available
  - lastTransitionTime: "2024-08-12T16:25:12Z"
    lastUpdateTime: "2024-08-12T16:25:42Z"
    message: ReplicaSet "video-app-7f5bc58cd6" has successfully progressed.
    reason: NewReplicaSetAvailable
    status: "True"
    type: Progressing
	 observedGeneration: 3
  readyReplicas: 1
  replicas: 1
  updatedReplicas: 1
  
kubectl get deployment video-app -o custom-columns=REVISION_TOTAL_COUNT:.metadata.generation,IMAGE_NAME:.'.spec.containers[0].image' > app-file.txt
 
cat app-file.txt
 
REVISION_TOTAL_COUNT   IMAGE_NAME
3                      redis:7.0.13

kubectl get deployment video-app -o custom-columns=REVISION_TOTAL_COUNT:.status.observedGeneration,IMAGE_NAME:.'.spec
.containers[0].image' > app-file.txt

cat app-file.txt 
REVISION_TOTAL_COUNT   IMAGE_NAME
3                      redis:7.0.13

Using both metadata.generation and status.observedGeneration still validation fails of this question on the KillrKoda

TRAINER INPUTS:

??

------------------------------------------------------------------------------------------------------------------------



